(self.webpackChunkvscroll_native=self.webpackChunkvscroll_native||[]).push([[216],{940:(e,t,i)=>{"use strict";i.d(t,{ZT:()=>r,pi:()=>o,mG:()=>s,Jh:()=>a,XA:()=>l,CR:()=>c,fl:()=>u});
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)};function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}var o=function(){return(o=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};function s(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{l(n.next(e))}catch(e){o(e)}}function a(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((n=n.apply(e,t||[])).next())}))}function a(e,t){var i,n,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,n&&(r=2&o[0]?n.return:o[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,o[1])).done)return r;switch(n=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(r=s.trys,(r=r.length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){s.label=o[1];break}if(6===o[0]&&s.label<r[1]){s.label=r[1],r=o;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(o);break}r[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],n=0}finally{i=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}Object.create;function l(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],n=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function c(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var n,r,o=i.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(e){r={error:e}}finally{try{n&&!n.done&&(i=o.return)&&i.call(o)}finally{if(r)throw r.error}}return s}function u(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(c(arguments[t]));return e}Object.create},177:(e,t,i)=>{"use strict";i.d(t,{h4:()=>_t,cK:()=>x});var n,r,o=i(940),s={name:"vscroll",version:"1.0.0-rc.2"},a=function(){function e(e,t){this.id=0,void 0!==e&&(this.value=e),this.options=t||{},this.subscriptions=new Map}return e.prototype.set=function(e){var t,i;if(this.value!==e||this.options.emitEqual){this.value=e;try{for(var n=(0,o.XA)(this.subscriptions),r=n.next();!r.done;r=n.next()){if((0,o.CR)(r.value,2)[1].emit(e),this.value!==e)break}}catch(e){t={error:e}}finally{try{r&&!r.done&&(i=n.return)&&i.call(n)}finally{if(t)throw t.error}}}},e.prototype.get=function(){return this.value},e.prototype.on=function(e){var t=this,i=this.id++,n={emit:e,off:function(){n.emit=function(){return null},t.subscriptions.delete(i)}};return this.subscriptions.set(i,n),this.options.emitOnSubscribe&&n.emit(this.value),function(){return n.off()}},e.prototype.once=function(e){var t=this.on((function(i){t(),e(i)}));return t},e.prototype.dispose=function(){this.subscriptions.forEach((function(e){return e.off()}))},e}();!function(e){e.id="id",e.mock="mock",e.version="version",e.init="init",e.init$="init$",e.packageInfo="packageInfo",e.itemsCount="itemsCount",e.bufferInfo="bufferInfo",e.isLoading="isLoading",e.isLoading$="isLoading$",e.loopPending="loopPending",e.loopPending$="loopPending$",e.firstVisible="firstVisible",e.firstVisible$="firstVisible$",e.lastVisible="lastVisible",e.lastVisible$="lastVisible$",e.bof="bof",e.bof$="bof$",e.eof="eof",e.eof$="eof$",e.reset="reset",e.reload="reload",e.append="append",e.prepend="prepend",e.check="check",e.remove="remove",e.clip="clip",e.insert="insert",e.replace="replace",e.fix="fix",e.relax="relax",e.showLog="showLog"}(n||(n={})),function(e){e[e.Scalar=0]="Scalar",e[e.Reactive=1]="Reactive",e[e.WorkflowRunner=2]="WorkflowRunner",e[e.Function=3]="Function"}(r||(r={}));var l,c=n,u=r,f=function(){return null},d={core:{name:"",version:""},consumer:{name:"",version:""}},p={firstIndex:NaN,lastIndex:NaN,minIndex:NaN,maxIndex:NaN,absMinIndex:-1/0,absMaxIndex:1/0},h={data:{},element:{}},g=function(){return[{type:u.Scalar,name:c.id,value:0,permanent:!0},{type:u.Scalar,name:c.mock,value:!0,permanent:!0},{type:u.Scalar,name:c.version,value:"",permanent:!0},{type:u.Scalar,name:c.init,value:!1,reactive:c.init$},{type:u.Scalar,name:c.packageInfo,value:d,onDemand:!0},{type:u.Scalar,name:c.itemsCount,value:0,onDemand:!0},{type:u.Scalar,name:c.bufferInfo,value:p,onDemand:!0},{type:u.Scalar,name:c.isLoading,value:!1,reactive:c.isLoading$},{type:u.Scalar,name:c.loopPending,value:!1,reactive:c.loopPending$},{type:u.Scalar,name:c.firstVisible,value:h,reactive:c.firstVisible$,wanted:!0},{type:u.Scalar,name:c.lastVisible,value:h,reactive:c.lastVisible$,wanted:!0},{type:u.Scalar,name:c.bof,value:!1,reactive:c.bof$},{type:u.Scalar,name:c.eof,value:!1,reactive:c.eof$},{type:u.WorkflowRunner,name:c.reset,value:f},{type:u.WorkflowRunner,name:c.reload,value:f},{type:u.WorkflowRunner,name:c.append,value:f},{type:u.WorkflowRunner,name:c.prepend,value:f},{type:u.WorkflowRunner,name:c.check,value:f},{type:u.WorkflowRunner,name:c.remove,value:f},{type:u.WorkflowRunner,name:c.clip,value:f},{type:u.WorkflowRunner,name:c.insert,value:f},{type:u.WorkflowRunner,name:c.replace,value:f},{type:u.WorkflowRunner,name:c.fix,value:f},{type:u.Function,name:c.relax,value:f},{type:u.Function,name:c.showLog,value:f},{type:u.Reactive,name:c.init$,value:new a},{type:u.Reactive,name:c.isLoading$,value:new a},{type:u.Reactive,name:c.loopPending$,value:new a},{type:u.Reactive,name:c.firstVisible$,value:new a(h,{emitOnSubscribe:!0})},{type:u.Reactive,name:c.lastVisible$,value:new a(h,{emitOnSubscribe:!0})},{type:u.Reactive,name:c.bof$,value:new a},{type:u.Reactive,name:c.eof$,value:new a}]},m=0,v=function(e){var t=this,i=e.mock,a=e.reactive,l=++m,c={configurable:!i};Object.defineProperty(this,n.id,(0,o.pi)({get:function(){return l}},c)),Object.defineProperty(this,n.mock,(0,o.pi)({get:function(){return i}},c)),Object.defineProperty(this,n.version,(0,o.pi)({get:function(){return s.version}},c)),g().filter((function(e){return!e.permanent})).forEach((function(e){var i=e.name,n=e.value,s=e.type;if(a&&s===r.Reactive){t.reactiveConfiguredProps=t.reactiveConfiguredProps||{};var l=a[i];l&&(t.reactiveConfiguredProps[i]=(0,o.pi)((0,o.pi)({},l),{default:n}),n=l.source)}Object.defineProperty(t,i,(0,o.pi)({get:function(){return n}},c))}))},b=function(e,t){this.get=e.get,e.settings&&(this.settings=e.settings),e.devSettings&&(this.devSettings=e.devSettings);var i=new v(t||{mock:!1});this.adapter=i},x=function(e){return function(t){function i(i){var n="function"==typeof e?e():void 0;return t.call(this,i,n)||this}return(0,o.ZT)(i,t),i}(b)},y=x();!function(e){e.number="must be a number",e.integer="must be an integer",e.integerUnlimited="must be an integer or infinity",e.moreOrEqual="must be a number greater than (or equal to) {arg1}",e.itemList="must be an array of items {arg1}",e.boolean="must be a boolean",e.object="must be an object",e.element="must be an html element",e.function="must be a function",e.funcOfxArguments="must have {arg1} argument(s)",e.funcOfxAndMoreArguments="must have at least {arg1} argument(s)",e.oneOfCan="can be present as only one item of {arg1} list",e.oneOfMust="must be present as only one item of {arg1} list",e.or="must satisfy at least 1 validator from {arg1} list"}(l||(l={}));var w,I,k=function(e,t){return e.replace("{arg1}",t||"")},S=function(e){return"number"==typeof e||"string"==typeof e&&""!==e?Number(e):NaN},z=function(e){var t=S(e),i=[];return Number.isNaN(t)&&i.push(l.number),{value:t,isSet:!0,isValid:!i.length,errors:i}},O=function(e,t){return function(i){var n=z(i);if(!n.isValid)return n;var r=n.value,o=[];return r<e&&(t?r=e:o.push(k(l.moreOrEqual,String(e)))),{value:r,isSet:!0,isValid:!o.length,errors:o}}},E=function(e){var t=[];return"function"!=typeof e&&t.push(l.function),{value:e,isSet:!0,isValid:!t.length,errors:t}},P=function(e,t){return function(i,n){var r=[],o=void 0!==i,s=!o,a=t?l.oneOfMust:l.oneOfCan;if(Array.isArray(e)&&e.length){for(var c=e.length-1;c>=0;c--){var u=e[c];if("string"!=typeof u){r.push(k(a,e.join('", "'))+" (non-string token)");break}var f=n&&Object.prototype.hasOwnProperty.call(n,u);if(o&&f){r.push(k(a,e.join('", "'))+" ("+u+" is present)");break}s&&f&&(s=!1)}t&&s&&r.push(k(a,e.join('", "')))}else r.push(k(a,"undefined"));return{value:i,isSet:o,isValid:!r.length,errors:r}}},N={NUMBER:{type:l.number,method:z},INTEGER:{type:l.integer,method:function(e){var t=[];e=S(e);var i=parseInt(String(e),10);return e!==i&&t.push(l.integer),{value:i,isSet:!0,isValid:!t.length,errors:t}}},INTEGER_UNLIMITED:{type:l.integerUnlimited,method:function(e){var t=e,i=[];return(e=S(e))!==(t=Number.isFinite(e)?parseInt(String(e),10):e)&&i.push(l.integerUnlimited),{value:t,isSet:!0,isValid:!i.length,errors:i}}},MORE_OR_EQUAL:function(e,t){return{type:l.moreOrEqual,method:O(e,t)}},BOOLEAN:{type:l.boolean,method:function(e){var t=[],i=e;return"true"===e?i=!0:"false"===e&&(i=!1),"boolean"!=typeof i&&t.push(l.boolean),{value:i,isSet:!0,isValid:!t.length,errors:t}}},OBJECT:{type:l.object,method:function(e){var t=[];return"[object Object]"!==Object.prototype.toString.call(e)&&t.push(l.object),{value:e,isSet:!0,isValid:!t.length,errors:t}}},ITEM_LIST:{type:l.itemList,method:function(e){var t=e,i=[];if(Array.isArray(e))if(e.length){if(e.length>1){var n=typeof e[0];e.some((function(e){return typeof e!==n}))&&i.push(k(l.itemList,"of items of the same type"))}}else i.push(k(l.itemList,"with at least 1 item"));else i.push(l.itemList),t=[];return{value:t,isSet:!0,isValid:!i.length,errors:i}}},ELEMENT:{type:l.element,method:function(e){var t=[];return e instanceof Element||e instanceof HTMLDocument||t.push(l.element),{value:e,isSet:!0,isValid:!t.length,errors:t}}},FUNC:{type:l.function,method:E},FUNC_WITH_X_ARGUMENTS:function(e){return{type:l.funcOfxArguments,method:(t=e,function(e){var i=E(e);if(!i.isValid)return i;var n=[];return(e=i.value).length!==t&&n.push(k(l.funcOfxArguments,String(t))),{value:e,isSet:!0,isValid:!n.length,errors:n}})};var t},FUNC_WITH_X_AND_MORE_ARGUMENTS:function(e){return{type:l.funcOfxAndMoreArguments,method:(t=e,function(e){var i=E(e);if(!i.isValid)return i;var n=[];return(e=i.value).length<t&&n.push(k(l.funcOfxArguments,String(t))),{value:e,isSet:!0,isValid:!n.length,errors:n}})};var t},ONE_OF_CAN:function(e){return{type:l.oneOfCan,method:P(e,!1)}},ONE_OF_MUST:function(e){return{type:l.oneOfMust,method:P(e,!0)}},OR:function(e){return{type:l.or,method:(t=e,function(e){var i=[];return t.every((function(t){return!t.method(e).isValid}))&&i.push(t.map((function(e){return e.type})).join(" OR ")),{value:e,isSet:!0,isValid:!i.length,errors:i}})};var t}},T=function(){function e(e){this.params={},this.contextErrors=[],this.errors=[],this.isValid=!0,this.setContext(e)}return e.prototype.setContext=function(e){e&&"[object Object]"===Object.prototype.toString.call(e)?this.isValidContext=!0:(this.setCommonError("context is not an object"),this.isValidContext=!1),this.context=e},e.prototype.setValidity=function(){var e=this;this.errors=Object.keys(this.params).reduce((function(t,i){return(0,o.fl)(t,e.params[i].errors)}),[]),this.isValid=!this.errors.length},e.prototype.setCommonError=function(e){this.contextErrors.push(e),this.errors.push(e),this.isValid=!1},e.prototype.setParam=function(e,t){t.isValid||(t.errors=t.isSet?t.errors.map((function(t){return'"'+e+'" '+t})):['"'+e+'" must be set']),this.params[e]=t,this.setValidity()},e.prototype.showErrors=function(){return this.errors.length?"validation failed: "+this.errors.join(", "):""},e}(),M=function(e,t,i){var n=e.value,r=e.errors,s=t.method(n,i),a=(0,o.fl)(r,s.errors);return{value:s.value,isSet:s.isSet,isValid:!a.length,errors:a}},V=function(e,t){var i=void 0===e,n=!t.mandatory&&void 0!==t.defaultValue;return{value:i?n?t.defaultValue:void 0:e,isSet:!i||n,isValid:!i||!t.mandatory,errors:[]}},$=function(e,t,i){var n,r,s=V(e[t],i);if(s.isSet)try{for(var a=(0,o.XA)(Object.values(i.validators)),c=a.next();!c.done;c=a.next()){var u=c.value,f=M(s,u,e);if(!f.isValid&&void 0!==i.defaultValue)return{value:i.defaultValue,isSet:!0,isValid:!0,errors:[]};Object.assign(s,f)}}catch(e){n={error:e}}finally{try{c&&!c.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}else{var d=i.validators.find((function(e){return e.type===l.oneOfMust}));if(d)return M(s,d,e)}return s},A=function(e,t){var i=new T(e);return Object.entries(t).forEach((function(e){var t=(0,o.CR)(e,2),n=t[0],r=t[1];return i.setParam(n,i.isValidContext?$(i.context,n,r):V(void 0,r))})),i},j=N.OBJECT,C=N.FUNC_WITH_X_AND_MORE_ARGUMENTS;!function(e){e.get="get",e.settings="settings",e.devSettings="devSettings"}(I||(I={}));var R,L,F,B,D,_=((w={})[I.get]={validators:[C(2)],mandatory:!0},w[I.settings]={validators:[j]},w[I.devSettings]={validators:[j]},w),W=N.NUMBER,U=N.INTEGER,Z=N.INTEGER_UNLIMITED,G=N.MORE_OR_EQUAL,H=N.BOOLEAN,X=N.ELEMENT,q=N.FUNC,Y=N.OR;!function(e){e.adapter="adapter",e.startIndex="startIndex",e.minIndex="minIndex",e.maxIndex="maxIndex",e.itemSize="itemSize",e.bufferSize="bufferSize",e.padding="padding",e.infinite="infinite",e.horizontal="horizontal",e.windowViewport="windowViewport",e.viewportElement="viewportElement",e.inverse="inverse",e.onBeforeClip="onBeforeClip"}(B||(B={})),function(e){e.debug="debug",e.immediateLog="immediateLog",e.logProcessRun="logProcessRun",e.logTime="logTime",e.throttle="throttle",e.initDelay="initDelay",e.initWindowDelay="initWindowDelay",e.cacheData="cacheData",e.changeOverflow="changeOverflow",e.dismissOverflowAnchor="dismissOverflowAnchor"}(D||(D={}));var J,Q,K,ee,te,ie,ne,re,oe,se,ae,le,ce,ue=((R={})[B.itemSize]=1,R[B.bufferSize]=1,R[B.padding]=.01,R[D.throttle]=0,R[D.initDelay]=0,R[D.initWindowDelay]=0,R),fe=((L={})[B.adapter]={validators:[H],defaultValue:!1},L[B.startIndex]={validators:[U],defaultValue:1},L[B.minIndex]={validators:[Z],defaultValue:-1/0},L[B.maxIndex]={validators:[Z],defaultValue:1/0},L[B.itemSize]={validators:[U,G(ue[B.itemSize],!0)],defaultValue:NaN},L[B.bufferSize]={validators:[U,G(ue[B.bufferSize],!0)],defaultValue:5},L[B.padding]={validators:[W,G(ue[B.padding],!0)],defaultValue:.5},L[B.infinite]={validators:[H],defaultValue:!1},L[B.horizontal]={validators:[H],defaultValue:!1},L[B.windowViewport]={validators:[H],defaultValue:!1},L[B.viewportElement]={validators:[Y([X,q])],defaultValue:null},L[B.inverse]={validators:[H],defaultValue:!1},L[B.onBeforeClip]={validators:[q],defaultValue:null},L),de=((F={})[D.debug]={validators:[H],defaultValue:!1},F[D.immediateLog]={validators:[H],defaultValue:!0},F[D.logProcessRun]={validators:[H],defaultValue:!1},F[D.logTime]={validators:[H],defaultValue:!1},F[D.throttle]={validators:[U,G(ue[D.throttle],!0)],defaultValue:40},F[D.initDelay]={validators:[U,G(ue[D.initDelay],!0)],defaultValue:1},F[D.initWindowDelay]={validators:[U,G(ue[D.initWindowDelay],!0)],defaultValue:40},F[D.cacheData]={validators:[H],defaultValue:!1},F[D.changeOverflow]={validators:[H],defaultValue:!1},F[D.dismissOverflowAnchor]={validators:[H],defaultValue:!0},F);!function(e){e.init="init",e.scroll="scroll",e.start="start",e.preFetch="preFetch",e.fetch="fetch",e.postFetch="postFetch",e.render="render",e.preClip="preClip",e.clip="clip",e.adjust="adjust",e.end="end"}(J||(J={})),function(e){e.reset="adapter.reset",e.reload="adapter.reload",e.append="adapter.append",e.prepend="adapter.prepend",e.check="adapter.check",e.remove="adapter.remove",e.replace="adapter.replace",e.clip="adapter.clip",e.insert="adapter.insert",e.fix="adapter.fix"}(Q||(Q={})),function(e){e.start="start",e.next="next",e.done="done",e.error="error"}(K||(K={}));var pe,he=N.INTEGER,ge=N.INTEGER_UNLIMITED,me=N.BOOLEAN,ve=N.OBJECT,be=N.ITEM_LIST,xe=N.FUNC_WITH_X_ARGUMENTS,ye=N.FUNC_WITH_X_AND_MORE_ARGUMENTS,we=N.ONE_OF_MUST,Ie=N.ONE_OF_CAN,ke=N.OR;pe||(pe={});var Se,ze=((ee={})[I.get]={validators:[ye(2)]},ee[I.settings]={validators:[ve]},ee[I.devSettings]={validators:[ve]},ee);!function(e){e.reloadIndex="reloadIndex"}(Se||(Se={}));var Oe,Ee=((te={})[Se.reloadIndex]={validators:[he]},te);!function(e){e.items="items",e.bof="bof",e.eof="eof"}(Oe||(Oe={}));var Pe,Ne=((ie={})[Oe.items]={validators:[be],mandatory:!0},ie[Oe.bof]={validators:[me,Ie([Oe.eof])]},ie[Oe.eof]={validators:[me,Ie([Oe.bof])]},ie);!function(e){e.predicate="predicate",e.indexes="indexes",e.increase="increase"}(Pe||(Pe={}));var Te,Me=((ne={})[Pe.predicate]={validators:[xe(1),we([Pe.indexes])]},ne[Pe.indexes]={validators:[be,we([Pe.predicate])]},ne[Pe.increase]={validators:[me],defaultValue:!1},ne);!function(e){e.backwardOnly="backwardOnly",e.forwardOnly="forwardOnly"}(Te||(Te={}));var Ve,$e=((re={})[Te.backwardOnly]={validators:[me,Ie([Te.forwardOnly])],defaultValue:!1},re[Te.forwardOnly]={validators:[me,Ie([Te.backwardOnly])],defaultValue:!1},re);!function(e){e.items="items",e.before="before",e.after="after",e.decrease="decrease"}(Ve||(Ve={}));var Ae,je=((oe={})[Ve.items]={validators:[be],mandatory:!0},oe[Ve.before]={validators:[xe(1),we([Ve.after])]},oe[Ve.after]={validators:[xe(1),we([Ve.before])]},oe[Ve.decrease]={validators:[me],defaultValue:!1},oe);!function(e){e.items="items",e.predicate="predicate",e.fixRight="fixRight"}(Ae||(Ae={}));var Ce,Re=((se={})[Ve.items]={validators:[be],mandatory:!0},se[Ae.predicate]={validators:[xe(1)],mandatory:!0},se[Ae.fixRight]={validators:[me],defaultValue:!1},se);!function(e){e.scrollPosition="scrollPosition",e.minIndex="minIndex",e.maxIndex="maxIndex",e.updater="updater",e.scrollToItem="scrollToItem",e.scrollToItemOpt="scrollToItemOpt"}(Ce||(Ce={}));var Le,Fe=((ae={})[Ce.scrollPosition]={validators:[ge]},ae[Ce.minIndex]={validators:[ge]},ae[Ce.maxIndex]={validators:[ge]},ae[Ce.updater]={validators:[xe(1)]},ae[Ce.scrollToItem]={validators:[xe(1)]},ae[Ce.scrollToItemOpt]={validators:[ke([me,ve])]},ae),Be=((le={})[Q.reset]=I,le[Q.reload]=Se,le[Q.append]=Oe,le[Q.prepend]=Oe,le[Q.check]=pe,le[Q.remove]=Pe,le[Q.clip]=Te,le[Q.insert]=Ve,le[Q.replace]=Ae,le[Q.fix]=Ce,le),De=((ce={})[Q.reset]=ze,ce[Q.reload]=Ee,ce[Q.append]=Ne,ce[Q.prepend]=Ne,ce[Q.check]={},ce[Q.remove]=Me,ce[Q.clip]=$e,ce[Q.insert]=je,ce[Q.replace]=Re,ce[Q.fix]=Fe,ce),_e=function(){function e(e,t,i){this.parseInput(e,fe),this.parseInput(t,de),this.instanceIndex=i,this.initializeDelay=this.getInitializeDelay(),this.viewport=this.getViewport()}return e.prototype.parseInput=function(e,t){var i=this,n=A(e,t);if(!n.isValid)throw new Error("Invalid settings");Object.entries(n.params).forEach((function(e){var t,n=(0,o.CR)(e,2),r=n[0],s=n[1];return Object.assign(i,((t={})[r]=s.value,t))}))},e.prototype.getInitializeDelay=function(){var e=0;return this.windowViewport&&this.initWindowDelay&&!("scrollRestoration"in history)&&(e=this.initWindowDelay),this.initDelay>0&&(e=Math.max(e,this.initDelay)),e},e.prototype.getViewport=function(){if("function"!=typeof this.viewportElement)return this.viewportElement;var e=this.viewportElement(),t=$({value:e},"value",{validators:[N.ELEMENT]});return t.isValid?t.value:null},e}(),We=function(e){var t;return(t=function(){}).process=e,t},Ue=function(e){var t;return(t=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return(0,o.ZT)(i,t),i.parseInput=function(t,i,n){void 0===n&&(n=!1);var r={data:A(i,De[e])};return r.data.isValid?r.params=Object.entries(r.data.params).reduce((function(e,t){var i,n=(0,o.CR)(t,2),r=n[0],s=n[1].value;return(0,o.pi)((0,o.pi)({},e),((i={})[r]=s,i))}),{}):(t.logger.log((function(){return r.data.showErrors()})),n||t.workflow.call({process:e,status:K.error,payload:{error:'Wrong argument of the "'+e+'" method call'}})),r},i}(We(e))).process=e,t},Ze=[J.init,Q.reset,Q.reload],Ge=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.ZT)(t,e),t.run=function(e,i){var n=e.state.cycle,r=e.workflow,o=Ze.includes(i);e.logger.logCycle(!0),n.start(o,i),r.call({process:t.process,status:K.next})},t}(We(J.init));!function(e){e.forward="forward",e.backward="backward"}(Le||(Le={}));var He=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.ZT)(t,e),t.run=function(e,i){var n=e.workflow,r=e.viewport.scrollPosition;t.onSynthetic(e,r)||t.onThrottle(e,r,(function(){return t.onScroll(e,n)}))},t.onSynthetic=function(e,t){var i=e.state.scrollState,n=i.syntheticPosition;if(null!==n){if(i.syntheticFulfill&&(i.syntheticPosition=null),!i.syntheticFulfill||n===t)return e.logger.log((function(){return["skipping scroll",t,"["+(i.syntheticFulfill?"":"pre-")+"synthetic]"]})),!0;e.logger.log((function(){return["synthetic scroll has been fulfilled:",t,t<n?"<":">",n]}))}return!1},t.onThrottle=function(e,i,n){var r=e.state.scrollState,o=e.settings.throttle,s=e.logger;r.current=t.getScrollEvent(i,r.previous);var a=r.current,l=a.direction,c=a.time,u=r.previous?c-r.previous.time:1/0,f=o-u,d=isFinite(f)&&f>0,p=!!r.scrollTimer;if(s.log((function(){return[l===Le.backward?"⤴":"⤵",i,d?u+"ms":"0ms",d?p?"delayed":"/ "+f+"ms delay":""]})),!d)return r.scrollTimer&&(clearTimeout(r.scrollTimer),r.scrollTimer=null),void n();p||(r.scrollTimer=setTimeout((function(){s.log((function(){var n=t.getScrollEvent(e.viewport.scrollPosition,r.current);return[n.direction===Le.backward?"⤴":"⤵",n.position,n.time-c+"ms","triggered by timer set on",i]})),r.scrollTimer=null,n()}),f))},t.getScrollEvent=function(e,t){var i=Number(new Date),n=Le.forward;return t&&(e===t.position?n=t.direction:e<t.position&&(n=Le.backward)),{position:e,direction:n,time:i}},t.onScroll=function(e,i){var n=e.state,r=n.scrollState,s=n.cycle;r.previous=(0,o.pi)({},r.current),r.current=null,s.busy.get()?e.logger.log((function(){return["skipping scroll",r.previous.position,"[pending]"]})):i.call({process:t.process,status:K.next})},t}(We(J.scroll)),Xe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.ZT)(t,e),t.run=function(e,i){var n=e.datasource,r=e.buffer,o=e.viewport.paddings,s=e.state.cycle;if(i){var a=t.parseInput(e,i).data;if(!a.isValid)return;var l=i instanceof y;Object.keys(De[t.process]).forEach((function(e){var t=a.params[e];(t.isSet||l&&n[e])&&(n[e]=t.value)}))}r.reset(!0),o.backward.reset(),o.forward.reset();var c={datasource:n};s.busy.get()&&(c.finalize=!0,s.interrupter=t.process),e.workflow.call({process:t.process,status:K.next,payload:c})},t}(Ue(Q.reset)),qe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.ZT)(t,e),t.run=function(e,i){var n=e.viewport,r=e.state,o=e.buffer,s=t.parseInput(e,{reloadIndex:i},!0).params;o.reset(!0,s?s.reloadIndex:void 0),n.reset(o.startIndex);var a={};r.cycle.busy.get()&&(r.scrollState.cleanupTimers(),a.finalize=!0,r.cycle.interrupter=t.process),e.workflow.call({process:t.process,status:K.next,payload:a})},t}(Ue(Q.reload)),Ye=function(){function e(e,t,i){this.container={$index:e,data:t},this.nodeId=String(e),this.routines=i,this.invisible=!0}return Object.defineProperty(e.prototype,"$index",{get:function(){return this.container.$index},set:function(e){this.container.$index=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return this.container.data},set:function(e){this.container.data=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"element",{get:function(){return this.container.element},set:function(e){this.container.element=e},enumerable:!1,configurable:!0}),e.prototype.setSize=function(){this.size=this.routines.getSize(this.element)},e.prototype.hide=function(){this.element&&this.routines.hideElement(this.element)},e.prototype.scrollTo=function(e){this.element&&this.routines.scrollTo(this.element,e)},e.prototype.updateIndex=function(e){this.$index=e,this.nodeId=String(e)},e.prototype.get=function(){return this.container},e}(),Je=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.ZT)(t,e),t.run=function(e,i){var n=i.process,r=i.options,o=t.parseInput(e,r).params;if(o){var s=o.items,a=o.bof,l=o.eof,c=n!==Q.append,u=!!(c?a:l);if(c&&u&&!e.buffer.bof.get()||!c&&u&&!e.buffer.eof.get())return t.doVirtualize(e,s,c),void e.workflow.call({process:t.process,status:K.done});t.simulateFetch(e,s,u,c),e.workflow.call({process:t.process,status:K.next})}},t.doVirtualize=function(e,t,i){var n=e.buffer,r=e.viewport.paddings,o=i?"absMinIndex":"absMaxIndex";if(isFinite(n[o])){var s=t.length*n.averageSize,a=i?r.backward:r.forward;n[o]+=(i?-1:1)*t.length,a.size+=s,i&&(e.viewport.scrollPosition+=s),e.logger.log((function(){return"buffer."+[o]+" value is set to "+n[o]})),e.logger.stat("after virtual "+(i?"prepend":"append"))}},t.simulateFetch=function(e,t,i,n){for(var r=e.buffer,o=e.state,s=e.state.fetch,a=n?"absMinIndex":"absMaxIndex",l=r.getIndexToAdd(i,n),c=r[a],u=[],f=0;f<t.length;f++){var d=new Ye(l,t[f],e.routines);isFinite(c)&&(n&&l<c||!n&&l>c)&&(c+=n?-1:1),(n?Array.prototype.unshift:Array.prototype.push).apply(u,[d]),l+=n?-1:1}return c!==r[a]&&(r[a]=c,e.logger.log((function(){return"buffer."+a+" value is set to "+r[a]}))),(n?s.prepend:s.append).call(s,u),(n?r.prepend:r.append).call(r,u),s.first.indexBuffer=isNaN(r.firstIndex)?l:r.firstIndex,s.last.indexBuffer=isNaN(r.lastIndex)?l:r.lastIndex,o.clip.noClip=!0,!0},t}(Ue(Q.append)),Qe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.ZT)(t,e),t.run=function(e){var i=e.workflow,n=e.buffer,r=e.state.fetch,o=e.viewport,s=1/0,a=-1/0;if(n.items.forEach((function(e){var t=e.size;e.setSize(),e.size!==t&&(n.cacheItem(e),s=Math.min(s,e.$index),a=Math.max(a,e.$index))})),Number.isFinite(s)){e.state.clip.noClip=!0,r.first.indexBuffer=n.firstIndex,r.last.indexBuffer=n.lastIndex;var l=o.getEdgeVisibleItem(n.items,Le.backward),c=l.item,u=l.diff;r.firstVisibleIndex=c?c.get().$index:NaN,isNaN(r.firstVisibleIndex)||(r.firstVisibleItemDelta=-n.getSizeByIndex(r.firstVisibleIndex)+u),r.replace(n.items.filter((function(e){return e.$index>=s&&e.$index<=a})))}e.logger.stat("check"),i.call({process:t.process,status:Number.isFinite(s)?K.next:K.done})},t}(Ue(Q.check)),Ke=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.ZT)(t,e),t.run=function(e,i){var n=t.parseInput(e,i).params;if(n){var r=t.doRemove(e,n);e.workflow.call({process:t.process,status:r?K.next:K.done})}},t.doRemove=function(e,i,n){void 0===n&&(n=!1);var r=t.removeBufferedItems(e,i),o=t.removeVirtualItems(e,i,n);if(r||o){var s=e.state.clip;s.simulate=!0,s.increase=!!i.increase,r?s.doClip=!0:s.virtual.only=!0}return r||o},t.removeBufferedItems=function(e,i){var n=i.predicate,r=i.indexes,o=!1;if(n&&(o=t.runPredicateOverBuffer(e,n)),r){o=t.runPredicateOverBuffer(e,(function(e){var t=e.$index;return r.indexOf(t)>=0}))}return o},t.runPredicateOverBuffer=function(e,t){for(var i=e.viewport,n=e.buffer.items,r=!1,o=NaN,s=0;s<n.length;s++){var a=n[s];if(t(a.get())){if(a.toRemove=!0,isNaN(o)){var l=i.getEdgeVisibleItem(n,Le.backward);o=l.item?l.item.get().$index:NaN}a.removeDirection=!isNaN(o)&&a.$index<o?Le.backward:Le.forward,r=!0}else if(!0===r)break}return r},t.removeVirtualItems=function(e,t,i){var n=t.indexes;if(!n)return!1;for(var r=NaN,o=e.state.clip,s=e.buffer,a=s.finiteAbsMinIndex,l=s.firstIndex,c=s.finiteAbsMaxIndex,u=s.lastIndex,f=0,d=n.length;f<d;f++){var p=null,h=n[f];if(h>=a&&!isNaN(l)&&h<l&&(p=Le.backward),h<=c&&!isNaN(u)&&h>u&&(p=Le.forward),null!==p){if(i&&!isNaN(r)&&Math.abs(r-h)>1)break;o.virtual[p].push(h),r=h}}return!isNaN(r)},t}(Ue(Q.remove)),et=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.ZT)(t,e),t.run=function(e,i){var n=t.parseInput(e,i).params;e.state.clip.forceForward=!(n&&n.backwardOnly),e.state.clip.forceBackward=!(n&&n.forwardOnly),e.workflow.call({process:t.process,status:K.next})},t}(Ue(Q.clip)),tt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.ZT)(t,e),t.run=function(e,i){var n=t.parseInput(e,i).params;if(n){var r=t.doInsert(e,n);e.workflow.call({process:t.process,status:r?K.next:K.done})}},t.doInsert=function(e,i){var n=i.before,r=i.after,o=i.items,s=i.decrease,a=n||r,l=e.buffer.items.find((function(e){return a(e.get())}));return!!l&&t.simulateFetch(e,l,o,!!n,!!s)},t.simulateFetch=function(e,t,i,n,r){var o=e.buffer,s=e.routines,a=e.state,l=a.fetch,c=a.clip,u=r?o.absMinIndex:o.absMaxIndex,f=n?0:1,d=i.length,p=i.map((function(e,i){return new Ye(t.$index+i+f-(r?d:0),e,s)}));return o.insertItems(p,t,f,!r),e.logger.log((function(){var e=r?o.absMinIndex:o.absMaxIndex;return"buffer."+(r?"absMinIndex":"absMaxIndex")+" value "+(u!==e?"has been changed from "+u+" to "+e:"has not been changed")})),l.insert(p),l.first.indexBuffer=o.firstIndex,l.last.indexBuffer=o.lastIndex,c.noClip=!0,!0},t}(Ue(Q.insert)),it=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.ZT)(t,e),t.run=function(e,i){var n=t.parseInput(e,i).params;if(n)return t.doRemove(e,n)?t.doInsert(e,n)?void e.workflow.call({process:t.process,status:K.next}):e.workflow.call({process:t.process,status:K.done}):(e.logger.log((function(){return"no items to replace (not found)"})),e.workflow.call({process:t.process,status:K.done}))},t.doRemove=function(e,t){var i={predicate:t.predicate,increase:t.fixRight};return Ke.doRemove(e,i,!0)},t.doInsert=function(e,t){var i={items:t.items,after:t.predicate,decrease:t.fixRight};return tt.doInsert(e,i)},t}(Ue(Q.replace)),nt=Be[Q.fix],rt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.ZT)(t,e),t.run=function(e,i){var n=e.workflow,r=t.parseInput(e,i),s=r.data;r.params&&(Object.entries(s.params).forEach((function(i){var n=(0,o.CR)(i,2),r=n[0],a=n[1];a.isSet&&a.isValid&&t.runByType(e,r,a.value,s)})),n.call({process:t.process,status:K.done}))},t.runByType=function(e,i,n,r){switch(i){case nt.scrollPosition:return t.setScrollPosition(e,n);case nt.minIndex:return t.setMinIndex(e,n);case nt.maxIndex:return t.setMaxIndex(e,n);case nt.updater:return t.updateItems(e,n);case nt.scrollToItem:if(r.params){var o=r.params[nt.scrollToItemOpt],s=o?o.value:void 0;return t.scrollToItem(e,n,s)}return;case nt.scrollToItemOpt:return}},t.setScrollPosition=function(e,t){var i=e.viewport,n=t;t===-1/0?n=0:t===1/0&&(n=i.getScrollableSize()),i.setPosition(n)},t.setMinIndex=function(e,t){var i=e.buffer;e.settings.minIndex=t,i.absMinIndex=t},t.setMaxIndex=function(e,t){var i=e.buffer;e.settings.maxIndex=t,i.absMaxIndex=t},t.updateItems=function(e,t){e.buffer.items.forEach((function(e){return t(e.get())}))},t.scrollToItem=function(e,t,i){var n=e.buffer.items.find((function(e){return t(e.get())}));n?n.scrollTo(i):e.logger.log((function(){return"scrollToItem cancelled, item not found"}))},t}(Ue(Q.fix)),ot=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.ZT)(t,e),t.run=function(e){var i=e.state;i.startInnerLoop(),e.workflow.call({process:t.process,status:K.next,payload:(0,o.pi)({},i.cycle.innerLoop.first?{process:i.cycle.initiator}:{})})},t}(We(J.start)),st=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.ZT)(t,e),t.run=function(e){var i=e.workflow,n=e.buffer,r=e.state,o=r.fetch,s=r.cycle;o.minIndex=n.minIndex,t.setPositionsAndIndexes(e),t.skipBufferedItems(e),e.settings.infinite&&t.checkBufferGaps(e),t.checkFetchPackSize(e),t.setFetchDirection(e),i.call({process:t.process,status:t.getStatus(e),payload:{process:s.initiator}})},t.setPositionsAndIndexes=function(e){t.setPositions(e),t.setFirstIndex(e),t.setLastIndex(e),e.logger.fetch()},t.setPositions=function(e){var i=e.state.fetch.positions,n=e.viewport,r=n.getBufferPadding();i.before=n.scrollPosition,i.startDelta=t.getStartDelta(e),i.relative=i.before-i.startDelta,i.start=i.relative-r,i.end=i.relative+n.getSize()+r},t.getStartDelta=function(e){var t=e.buffer,i=e.viewport.offset,n=0;if(i&&(n+=i),!t.hasItemSize)return n;for(var r=t.finiteAbsMinIndex;r<t.startIndex;r++)n+=t.getSizeByIndex(r);return e.logger.log((function(){return(0,o.fl)(["start delta is "+n],i?[" (+"+i+" offset)"]:[])})),n},t.setFirstIndex=function(e){var t=e.state,i=e.buffer,n=t.fetch,r=n.positions.start,o=n.first,s=i.startIndex,a=0;if(t.cycle.innerLoop.isInitial)e.logger.log("skipping fetch backward direction [initial loop]");else if(i.hasItemSize)for(var l=a,c=s;;){if(r>=0){var u=i.getSizeByIndex(c);if(l+u-r>0){s=c,a=l;break}if(l+=u,++c<i.absMinIndex)break}if(r<0){if(--c<i.absMinIndex)break;if(s=c,a=l-=i.getSizeByIndex(c),l-r<=0)break}}else e.logger.log("skipping fetch backward direction [no item size]");o.index=o.indexBuffer=Math.max(s,i.absMinIndex),o.position=a},t.setLastIndex=function(e){var t,i=e.state,n=i.fetch,r=i.cycle,o=e.buffer,s=e.settings,a=n.positions,l=a.relative,c=a.end,u=n.first,f=n.last;if(o.hasItemSize){var d=u.indexBuffer,p=u.position;for(t=d;;){t=d;var h=o.getSizeByIndex(d);if(p+=h,isNaN(n.firstVisibleIndex)&&p>l&&(n.firstVisibleIndex=d,r.innerLoop.isInitial||(n.firstVisibleItemDelta=p-h-l)),p>=c)break;if(d++>o.absMaxIndex)break}}else t=o.startIndex+s.bufferSize-1,e.logger.log("forcing fetch forward direction [no item size]");f.index=f.indexBuffer=Math.min(t,o.absMaxIndex)},t.skipBufferedItems=function(e){var t=e.buffer;if(t.size){for(var i=e.state.fetch,n=i.first.index,r=i.last.index,o=[[]],s=0,a=n;a<=r;a++)t.get(a)?o[s].length&&(o[++s]=[]):o[s].push(a);var l=o[0];o[0].length&&o[1]&&o[1].length&&(i.hasAnotherPack=!0,o[1].length>=o[0].length&&(l=o[1])),i.first.index=Math.max(l[0],t.absMinIndex),i.last.index=Math.min(l[l.length-1],t.absMaxIndex),i.first.index===n&&i.last.index===r||e.logger.fetch("after Buffer flushing")}},t.checkBufferGaps=function(e){var t=e.buffer,i=e.state.fetch;if(t.size){var n=i.first.index,r=t.lastIndex;n>r&&(i.first.index=i.first.indexBuffer=r+1);var o=t.firstIndex,s=i.last.index;s<o&&(i.last.index=i.last.indexBuffer=o-1),i.first.index===n&&i.last.index===s||e.logger.fetch("after Buffer filling (no clip case)")}},t.checkFetchPackSize=function(e){var i=e.buffer,n=e.state.fetch;if(n.shouldFetch){var r=n.first.index,o=n.last.index,s=e.settings.bufferSize-(o-r+1);if(!(s<=0)){if(!i.size||o>i.items[0].$index){var a=Math.min(o+s,i.absMaxIndex);a>o&&(n.last.index=n.last.indexBuffer=a)}else{var l=Math.max(r-s,i.absMinIndex);l<r&&(n.first.index=n.first.indexBuffer=l)}n.first.index===r&&n.last.index===o||(e.logger.fetch("after bufferSize adjustment"),t.skipBufferedItems(e))}}},t.setFetchDirection=function(e){var t=e.buffer,i=e.state.fetch;if(i.last.index){var n=Le.forward;t.size&&(n=i.last.index<t.items[0].$index?Le.backward:Le.forward),i.direction=n,e.logger.log((function(){return'fetch direction is "'+n+'"'}))}},t.getStatus=function(e){var t=e.state,i=t.cycle,n=t.fetch;return i.initiator===Q.clip?(e.logger.log((function(){return'going to skip fetch due to "'+Q.clip+'" process'})),K.next):n.shouldFetch?(e.logger.log((function(){return"going to fetch "+n.count+" items started from index "+n.index})),K.next):K.done},t}(We(J.preFetch)),at=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.ZT)(t,e),t.run=function(e){var i=e.workflow,n={success:function(n){e.logger.log((function(){return"resolved "+n.length+" items (index = "+e.state.fetch.index+", count = "+e.state.fetch.count+")"})),e.state.fetch.newItemsData=n,i.call({process:t.process,status:K.next})},fail:function(e){return i.call({process:t.process,status:K.error,payload:{error:e}})}},r=t.get(e);t.complete(e,n,r)},t.complete=function(e,t,i){if(Object.prototype.hasOwnProperty.call(i,"data")){var n=i,r=n.data,o=n.error;n.isError?t.fail(o):t.success(r||[])}else{var s=e.state,a=s.scrollState,l=s.fetch,c=e.viewport;null===a.positionBeforeAsync&&(a.positionBeforeAsync=c.scrollPosition),l.cancel=function(){t.success=function(){return null},t.fail=function(){return null}},i.then((function(e){return t.success(e)}),(function(e){return t.fail(e)}))}},t.get=function(e){var t,i,n,r,o=e.datasource.get,s=e.state.fetch,a=function(e){n?n(e):t=e||null},l=function(e){r?r(e):i=e||null},c=o(s.index,s.count,a,l);if(c&&"object"==typeof c&&null!==c){if("function"==typeof c.then)return c;if("function"==typeof c.subscribe)var u=c.subscribe(a,l,(function(){return u.unsubscribe()}))}return t||i?{data:i?null:t||[],error:i,isError:!!i}:new Promise((function(e,t){n=e,r=t}))},t}(We(J.fetch)),lt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.ZT)(t,e),t.run=function(e){var i=e.workflow;t.setItems(e)?(t.setBufferLimits(e),i.call({process:t.process,status:e.state.fetch.hasNewItems?K.next:K.done})):i.call({process:t.process,status:K.error,payload:{error:"Can't set buffer items"}})},t.setBufferLimits=function(e){var t=e.buffer,i=e.state,n=i.fetch,r=i.fetch.items,o=i.cycle.innerLoop,s=n.first.index,a=n.last.index;if(r.length){var l=r.length-1;s<r[0].$index&&(t.absMinIndex=r[0].$index),a>r[l].$index&&(t.absMaxIndex=r[l].$index)}else(a<t.minIndex||o.isInitial)&&(t.absMinIndex=t.minIndex),(s>t.maxIndex||o.isInitial)&&(t.absMaxIndex=t.maxIndex)},t.setItems=function(e){var t=e.buffer,i=e.state,n=i.fetch,r=i.cycle,o=n.newItemsData;if(!o||!o.length)return!0;var s=n.index;return o.length<n.count&&(r.innerLoop.isInitial?s=t.startIndex:n.first.index<t.minIndex&&(s=t.minIndex-o.length)),n.items=o.map((function(t,i){return new Ye(s+i,t,e.routines)})),n.isPrepend=!!t.items.length&&t.items[0].$index>n.items[n.items.length-1].$index,t.setItems(n.items)},t}(We(J.postFetch)),ct=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.ZT)(t,e),t.run=function(e){var i=e.workflow,n=e.state,r=n.cycle,o=n.render,s=n.scrollState,a=e.viewport;e.logger.stat("before new items render"),null===s.positionBeforeAsync&&(s.positionBeforeAsync=a.scrollPosition),o.renderTimer=setTimeout((function(){o.renderTimer=null,t.processElements(e)?i.call({process:t.process,status:o.noSize?K.done:K.next,payload:{process:r.initiator}}):i.call({process:t.process,status:K.error,payload:{error:"Can't associate item with element"}})}),0)},t.processElements=function(e){var i=e.state,n=i.fetch,r=i.render,o=e.viewport,s=e.buffer,a=e.logger;return r.positionBefore=o.scrollPosition,!(!n.isReplace&&(r.sizeBefore=o.getScrollableSize(),n.items.map((function(i){return t.processElement(e,i)})).some((function(e){return!e}))))&&(s.checkAverageSize(),r.sizeAfter=o.getScrollableSize(),a.stat("after new items render"),a.log((function(){return r.noSize?"viewport size has not been changed":void 0})),!0)},t.processElement=function(e,t){var i=e.state.fetch,n=e.viewport,r=e.buffer,o=n.element.querySelector('[data-sid="'+t.nodeId+'"]');return!!o&&(t.element=o,t.element.style.left="",t.element.style.position="",t.invisible=!1,t.setSize(),r.cacheItem(t),t.$index<i.minIndex&&(i.negativeSize+=t.size),!0)},t}(We(J.render)),ut=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.ZT)(t,e),t.run=function(e){var i=e.workflow,n=e.viewport,r=e.state.scrollState;if(r.positionBeforeAdjust=n.scrollPosition,!t.setPaddings(e))return i.call({process:t.process,status:K.error,payload:{error:"Can't get visible item"}});r.positionAfterAdjust=n.scrollPosition;var o=t.calculatePosition(e);t.setPosition(e,o,(function(){return i.call({process:t.process,status:K.done})}))},t.setPaddings=function(e){var t=e.viewport,i=e.buffer,n=e.settings.inverse,r=i.getFirstVisibleItem(),o=i.getLastVisibleItem();if(!r||!o)return!1;var s,a=t.paddings,l=a.forward,c=a.backward,u=0,f=0;for(s=i.finiteAbsMinIndex;s<r.$index;s++)u+=i.getSizeByIndex(s);for(s=o.$index+1;s<=i.finiteAbsMaxIndex;s++)f+=i.getSizeByIndex(s);var d=t.getScrollableSize()-l.size-c.size,p=t.getSize()-(u+d+f);return p>0&&(n?u+=p:f+=p,e.logger.log((function(){return n?"backward":"forward padding will be increased by "+p+" to fill the viewport"}))),c.size=u,l.size=f,e.logger.stat("after paddings adjustments"),!0},t.calculatePosition=function(e){var t=e.viewport,i=e.buffer,n=e.state,r=n.fetch,o=n.render,s=n.scrollState,a=t.paddings.backward.size;if(isNaN(r.firstVisibleIndex)||isNaN(i.firstIndex))r.isPrepend&&r.negativeSize&&(a+=r.negativeSize);else{for(var l=i.firstIndex;l<r.firstVisibleIndex;l++)a+=i.getSizeByIndex(l);r.firstVisibleItemDelta&&(a-=r.firstVisibleItemDelta)}if(null!==s.positionBeforeAsync){var c=o.positionBefore-s.positionBeforeAsync;0!==c&&(e.logger.log("shift position due to fetch-render difference ("+c+")"),a+=c)}return t.offset>0&&(a||r.positions.before)&&(a+=t.offset),Math.round(a)},t.setPosition=function(e,t,i){var n=e.state.scrollState,r=e.viewport;if(!n.hasPositionChanged(t))return i();n.syntheticPosition=t,n.syntheticFulfill=!1,n.animationFrameId=requestAnimationFrame((function(){var o=n.positionAfterAdjust-r.scrollPosition,s="";o>0&&(t-=o,n.syntheticPosition=t,s=" (-"+o+")"),n.syntheticFulfill=!0,r.scrollPosition=t,e.logger.stat("after scroll adjustment"+s),i()}))},t}(We(J.adjust)),ft=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.ZT)(t,e),t.run=function(e){t.prepareClip(e),e.workflow.call({process:t.process,status:K.next,payload:{doClip:e.state.clip.doClip}})},t.prepareClip=function(e){var i=e.state,n=i.fetch,r=i.clip;if(!t.shouldNotClip(e)){var o=n.first.indexBuffer,s=n.last.indexBuffer;e.logger.log((function(){return"looking for "+(n.direction?"anti-"+n.direction+" ":"")+"items that are out of ["+o+".."+s+"] range"})),t.isBackward(e,o)&&t.prepareClipByDirection(e,Le.backward,o),t.isForward(e,s)&&t.prepareClipByDirection(e,Le.forward,s),r.doClip||e.logger.log("skipping clip [no items to clip]")}},t.shouldNotClip=function(e){var t=e.settings,i=e.buffer,n=e.state;return t.infinite?(e.logger.log("skipping clip [infinite mode]"),!0):i.size?!!n.cycle.isInitial&&(e.logger.log("skipping clip [initial cycle]"),!0):(e.logger.log("skipping clip [empty buffer]"),!0)},t.isBackward=function(e,t){var i=e.buffer,n=e.state,r=n.clip,o=n.fetch;return r.force?r.forceBackward:o.direction!==Le.backward&&t-1>=i.absMinIndex},t.isForward=function(e,t){var i=e.buffer,n=e.state,r=n.clip,o=n.fetch;return r.force?r.forceForward:o.direction!==Le.forward&&t+1<=i.absMaxIndex},t.prepareClipByDirection=function(e,t,i){var n=t===Le.forward;e.buffer.items.forEach((function(r){(!n&&r.$index<i||n&&r.$index>i)&&(r.toRemove=!0,r.removeDirection=t,e.state.clip.doClip=!0)}))},t}(We(J.preClip)),dt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.ZT)(t,e),t.run=function(e){var i=e.workflow,n=e.state;t.doClip(e),i.call({process:t.process,status:K.next,payload:{process:n.cycle.initiator}})},t.doClip=function(e){var i=e.viewport,n=e.logger,r=e.state.clip,o=i.scrollPosition;n.stat("before clip ("+ ++r.callCount+")"),r.virtual.only||t.onBuffered(e),r.virtual.has&&t.onVirtual(e),i.scrollPosition=o,n.stat("after clip")},t.onBuffered=function(e){var t=e.buffer,i=e.viewport.paddings,n=e.logger,r=e.state.clip,o={backward:0,forward:0},s=r.simulate&&!r.force,a=t.items.filter((function(e){if(!e.toRemove)return!1;(e.hide(),o[e.removeDirection]+=e.size,s)||(i.byDirection(e.removeDirection).size+=e.size);return!0}));e.settings.onBeforeClip&&a.length&&e.settings.onBeforeClip(a.map((function(e){return e.get()})));var l=a.map((function(e){return e.$index}));s?t.removeItems(l,!r.increase,!1):t.items=t.items.filter((function(e){return!e.toRemove})),n.log((function(){return l.length?["clipped "+l.length+" item(s) from Buffer"+(s?" (via adapter), -"+(o.backward+o.forward)+"px":(o.backward?", +"+o.backward+" fwd px":"")+(o.forward?", +"+o.forward+" bwd px":""))+", range: ["+l[0]+".."+l[l.length-1]+"]"]:"clipped 0 items from Buffer"}))},t.onVirtual=function(e){var t=e.buffer,i=e.viewport.paddings,n=e.logger,r=e.state.clip,o={backward:0,forward:0},s=r.virtual.all;[Le.backward,Le.forward].forEach((function(e){o[e]=r.virtual[e].reduce((function(e,i){return e+t.getSizeByIndex(i)}),0),i[e].size-=o[e]})),t.removeItems(s,!r.increase,!0),n.log((function(){return["clipped "+s.length+" virtual item(s)"+(o.backward?", +"+o.backward+" fwd px":"")+(o.forward?", +"+o.forward+" bwd px":"")+", ["+s.join(" ")+"]"]}))},t}(We(J.clip)),pt=function(e){return!!e.call.interrupted},ht=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.ZT)(t,e),t.run=function(e,i){var n=(void 0===i?{}:i).error,r=e.workflow,s=e.state.cycle.interrupter;if(n||s||t.calculateParams(e,r),pt(r))r.call({process:t.process,status:K.done});else{var a=t.finalizeInnerLoop(e,n);r.call({process:t.process,status:a?K.next:K.done,payload:(0,o.pi)({},s?{process:s}:{})})}},t.calculateParams=function(e,t){var i,n=e.adapter,r=e.viewport,o=e.buffer.items;n.wanted.firstVisible&&((i=r.getEdgeVisibleItem(o,Le.backward).item)&&i.element===n.firstVisible.element||(n.firstVisible=i?i.get():h));n.wanted.lastVisible&&!pt(t)&&((i=r.getEdgeVisibleItem(o,Le.forward).item)&&i.element===n.lastVisible.element||(n.lastVisible=i?i.get():h))},t.finalizeInnerLoop=function(e,i){var n=e.state,r=e.state,o=r.cycle,s=r.clip,a=r.fetch,l=!!o.interrupter||!i&&t.getNext(e);return o.innerLoop.isInitial=!1,a.stopSimulate(),s.noClip=e.settings.infinite||l&&s.simulate,s.forceReset(),n.endInnerLoop(),l},t.getNext=function(e){var t=e.state,i=t.clip,n=t.fetch,r=t.render;return!!i.simulate||(!(!n.simulate||!n.isReplace)||(!(!n.simulate||r.noSize)||!(n.simulate||!(n.hasNewItems&&!r.noSize||n.hasAnotherPack))))},t}(We(J.end)),gt=function(){function e(e,t){var i=this;this.logs=[],this.logAdapterMethod=function(e,t,n){if(i.debug){var r=(void 0===t?[]:Array.isArray(t)?t:[t]).map((function(e){return"function"==typeof e?"func":"object"==typeof e&&e?Array.isArray(e)?"[of "+e.length+"]":"{ "+Object.keys(e).join(", ")+" }":e})).join(", ");i.log("adapter: "+e+"("+(r||"")+")"+(n||""))}};var n=e.settings;this.debug=n.debug,this.immediateLog=n.immediateLog,this.logTime=n.logTime,this.getTime=function(){return e.state&&" // time: "+e.state.time},this.getStat=function(){var t=e.buffer,i=e.viewport,n=t.getFirstVisibleItem(),r=t.getLastVisibleItem();return"pos: "+i.scrollPosition+", size: "+i.getScrollableSize()+", bwd_p: "+i.paddings.backward.size+", fwd_p: "+i.paddings.forward.size+", aver: "+(t.hasItemSize?t.averageSize:"no")+", items: "+t.getVisibleItemsCount()+", range: "+(n&&r?"["+n.$index+".."+r.$index+"]":"no")},this.getFetchRange=function(){var t=e.state.fetch,i=t.first.index,n=t.last.index;return Number.isNaN(i)||Number.isNaN(n)?"no":"["+i+".."+n+"]"},this.getLoopId=function(){return e.state.cycle.loopId},this.getLoopIdNext=function(){return e.state.cycle.loopIdNext},this.getWorkflowCycleData=function(){return n.instanceIndex+"-"+e.state.cycle.count},this.getScrollPosition=function(t){return e.routines.getScrollPosition(t)},this.log((function(){return"uiScroll Workflow has been started, core: "+t.core.name+" v"+t.core.version+" (instance "+n.instanceIndex+"), consumer: "+t.consumer.name+" v"+t.consumer.version}))}return e.prototype.object=function(e,t,i){this.log((function(){return[e,i?JSON.stringify(t,(function(e,t){return Number.isNaN(t)?"NaN":t===1/0?"Infinity":t===-1/0?"-Infinity":t instanceof Element?"HTMLElement":t instanceof HTMLDocument?"HTMLDocument":"function"==typeof t?"Function":t})).replace(/"/g,"").replace(/(\{|:|,)/g,"$1 ").replace(/(\})/g," $1"):t]}))},e.prototype.stat=function(e){var t=this;if(this.debug){var i=["color: #888; border: dashed #888 0; border-bottom-width: 0px","color: #000; border-width: 0"];this.log((function(){return(0,o.fl)(["%cstat"+(e?" "+e:"")+",%c "+t.getStat()],i)}))}},e.prototype.fetch=function(e){var t=this;if(this.debug){var i="fetch interval"+(e?" "+e:""),n=["color: #888","color: #000"];this.log((function(){return(0,o.fl)(["%c"+i+": %c"+t.getFetchRange()],n)}))}},e.prototype.prepareForLog=function(e){return e instanceof Event&&e.target?this.getScrollPosition(e.target):e},e.prototype.logProcess=function(e){if(this.debug){var t=e.process,i=e.status,n=e.payload,r=[];if(t===J.init&&i===K.next)r.push("%c---=== loop "+this.getLoopIdNext()+" start");else if(t===J.end){r.push("%c---=== loop "+this.getLoopId()+" done");var s=n&&n.process;i===K.next&&s!==Q.reset&&s!==Q.reload&&(r[0]+=", loop "+this.getLoopIdNext()+" start")}r.length&&this.log((function(){return(0,o.fl)(r,["color: #006600;"])}))}},e.prototype.logCycle=function(e){void 0===e&&(e=!0);var t=this.getWorkflowCycleData(),i="color: #0000aa; border: solid #555 1px; border-width: "+(e?"1px 0 0 1px":"0 0 1px 1px")+"; margin-left: -2px";this.log((function(){return["%c   ~~~ WF Cycle "+t+" "+(e?"STARTED":"FINALIZED")+" ~~~  ",i]}))},e.prototype.logError=function(e){var t=this;if(this.debug){var i=["color: #a00;","color: #000"];this.log((function(){return(0,o.fl)(["error:%c"+(e?" "+e:"")+"%c (loop "+t.getLoopIdNext()+")"],i)}))}},e.prototype.log=function(){for(var e=this,t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];if(this.debug){if("function"==typeof t[0]&&(t=t[0](),Array.isArray(t)||(t=[t])),t.every((function(e){return void 0===e})))return;this.logTime&&(t=(0,o.fl)(t,[this.getTime()])),t=t.map((function(t){return e.prepareForLog(t)})),this.immediateLog?console.log.apply(this,t):this.logs.push(t)}},e.prototype.logForce=function(){for(var e=this,t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];this.debug&&(!this.immediateLog&&this.logs.length&&(this.logs.forEach((function(t){return console.log.apply(e,t)})),this.logs=[]),t.length&&console.log.apply(this,t))},e}(),mt=function(){function e(e){this.horizontal=e.horizontal,this.window=e.windowViewport}return e.prototype.checkElement=function(e){if(!e)throw new Error("HTML element is not defined")},e.prototype.getScrollPosition=function(e){return this.window?window.pageYOffset:(this.checkElement(e),e[this.horizontal?"scrollLeft":"scrollTop"])},e.prototype.setScrollPosition=function(e,t){t=Math.max(0,t),this.window?this.horizontal?window.scrollTo(t,window.scrollY):window.scrollTo(window.scrollX,t):(this.checkElement(e),e[this.horizontal?"scrollLeft":"scrollTop"]=t)},e.prototype.getParams=function(e,t){return this.checkElement(e),this.window&&t?{height:e.clientHeight,width:e.clientWidth,top:e.clientTop,bottom:e.clientTop+e.clientHeight,left:e.clientLeft,right:e.clientLeft+e.clientWidth}:e.getBoundingClientRect()},e.prototype.getSize=function(e,t){return this.getParams(e,t)[this.horizontal?"width":"height"]},e.prototype.getSizeStyle=function(e){this.checkElement(e);var t=e.style[this.horizontal?"width":"height"];return parseInt(t,10)||0},e.prototype.setSizeStyle=function(e,t){this.checkElement(e),t=Math.max(0,Math.round(t)),e.style[this.horizontal?"width":"height"]=t+"px"},e.prototype.getEdge=function(e,t,i){return this.getParams(e,i)[t===Le.forward?this.horizontal?"right":"bottom":this.horizontal?"left":"top"]},e.prototype.getEdge2=function(e,t,i,n){return e.offsetTop-(i?i.scrollTop:0)+(t===(n?Le.backward:Le.forward)?this.getSize(e):0)},e.prototype.hideElement=function(e){this.checkElement(e),e.style.display="none"},e.prototype.getOffset=function(e){return this.checkElement(e),(this.horizontal?e.offsetLeft:e.offsetTop)||0},e.prototype.scrollTo=function(e,t){this.checkElement(e),e.scrollIntoView(t)},e}(),vt=function(){function e(e,t,i){this.element=e.querySelector("[data-padding-"+t+"]"),this.direction=t,this.routines=i}return e.prototype.reset=function(e){this.size=e||0},Object.defineProperty(e.prototype,"size",{get:function(){return this.routines.getSizeStyle(this.element)},set:function(e){this.routines.setSizeStyle(this.element,e)},enumerable:!1,configurable:!0}),e}(),bt=function(){function e(e,t,i){this.settings=i,this.forward=new vt(e,Le.forward,t),this.backward=new vt(e,Le.backward,t)}return e.prototype.byDirection=function(e,t){return e===Le.backward?t?this.forward:this.backward:t?this.backward:this.forward},e.prototype.reset=function(e,t,i){var n,r=this.getPositiveSize(t,e,i),o=this.getNegativeSize(t);this.settings.inverse?(this.forward.reset(o),this.backward.reset(r),(n=e-this.backward.size-i)>0&&(this.backward.size+=n,this.forward.size-=n)):(this.forward.reset(r),this.backward.reset(o),(n=e-this.forward.size-i)>0&&(this.backward.size-=n,this.forward.size+=n))},e.prototype.getPositiveSize=function(e,t,i){var n=this.settings,r=t;return isFinite(n.maxIndex)&&(r=(n.maxIndex-e+1)*n.itemSize),i&&(r=Math.max(r-i,0)),r},e.prototype.getNegativeSize=function(e){var t=this.settings,i=0;return isFinite(t.minIndex)&&(i=(e-t.minIndex)*t.itemSize),i},e}(),xt=function(){function e(e,t,i,n,r){this.element=e,this.settings=t,this.routines=i,this.state=n,this.logger=r,this.disabled=!1,t.windowViewport?(this.hostElement=document.documentElement,this.scrollEventReceiver=window):(this.hostElement=t.viewport||this.element.parentElement,this.scrollEventReceiver=this.hostElement),this.paddings=new bt(this.element,this.routines,t),t.windowViewport&&"scrollRestoration"in history&&(history.scrollRestoration="manual"),t.dismissOverflowAnchor&&(this.hostElement.style.overflowAnchor="none")}return e.prototype.reset=function(e){this.setOffset(),this.paddings.reset(this.getSize(),e,this.offset),this.scrollPosition=this.paddings.backward.size||0,this.state.scrollState.reset()},e.prototype.setPosition=function(e){if(this.scrollPosition===e)return this.logger.log((function(){return["setting scroll position at",e,"[cancelled]"]})),e;this.routines.setScrollPosition(this.hostElement,e);var t=this.scrollPosition;return this.logger.log((function(){return(0,o.fl)(["setting scroll position at",t],t!==e?["("+e+")"]:[])})),t},Object.defineProperty(e.prototype,"scrollPosition",{get:function(){return this.routines.getScrollPosition(this.hostElement)},set:function(e){this.setPosition(e)},enumerable:!1,configurable:!0}),e.prototype.disableScrollForOneLoop=function(){var e=this;if(!this.disabled){var t=this.hostElement.style;if("hidden"!==t.overflowY){this.disabled=!0;var i=t.overflowY;setTimeout((function(){e.disabled=!1,t.overflowY=i})),t.overflowY="hidden"}}},e.prototype.getSize=function(){return this.routines.getSize(this.hostElement,!0)},e.prototype.getScrollableSize=function(){return this.routines.getSize(this.element)},e.prototype.getBufferPadding=function(){return this.getSize()*this.settings.padding},e.prototype.getEdge=function(e){return this.routines.getEdge(this.hostElement,e,!0)},e.prototype.setOffset=function(){this.offset=this.routines.getOffset(this.element),this.settings.windowViewport||(this.offset-=this.routines.getOffset(this.hostElement))},e.prototype.getEdgeVisibleItem=function(e,t){for(var i,n=t===Le.backward,r=n?Le.forward:Le.backward,o=this.getEdge(t),s=0,a=n?0:e.length-1;n?a<=e.length-1:a>=0;a+=n?1:-1){if(s=this.routines.getEdge(e[a].element,r)-o,n&&s>0||!n&&s<0){i=e[a];break}}return{item:i,diff:s}},e}(),yt=function(){function e(e,t){this.$index=e.$index,this.nodeId=e.nodeId,this.data=t?e.data:null,this.size=e.size}return e.prototype.changeIndex=function(e){this.$index=e,this.nodeId=String(e)},e}(),wt=function(){function e(){this.reset()}return e.prototype.reset=function(){this.newItems=[],this.oldItems=[]},e}(),It=function(){function e(e,t,i){this.averageSizeFloat=e,this.averageSize=e,this.itemSize=e,this.saveData=t,this.items=new Map,this.recalculateAverage=new wt,this.reset(),this.logger=i}return e.prototype.reset=function(){this.minIndex=1/0,this.maxIndex=-1/0,this.items.clear(),this.averageSizeFloat=this.itemSize,this.averageSize=this.itemSize,this.recalculateAverage.reset()},e.prototype.recalculateAverageSize=function(){var e=this,t=this.recalculateAverage,i=t.oldItems.length,n=t.newItems.length;if(!i&&!n)return!1;if(i){var r=this.recalculateAverage.oldItems.reduce((function(e,t){return e+t.size}),0),o=this.recalculateAverage.oldItems.reduce((function(e,t){return e+t.newSize}),0),s=this.averageSizeFloat||0;this.averageSizeFloat=s-(r-o)/(this.items.size-n)}if(n){o=this.recalculateAverage.newItems.reduce((function(e,t){return e+t.size}),0),s=this.averageSizeFloat||0;var a=this.items.size-n;this.averageSizeFloat=(a*s+o)/this.items.size}return this.averageSize=Math.round(this.averageSizeFloat),this.recalculateAverage.reset(),this.logger.log((function(){return"average size has been updated: "+e.averageSize})),!0},e.prototype.add=function(e){var t=this.get(e.$index);return t?(t.data=e.data,t.size!==e.size&&(this.recalculateAverage.oldItems.push({$index:e.$index,size:t.size,newSize:e.size}),t.size=e.size)):(t=new yt(e,this.saveData),this.items.set(e.$index,t),this.averageSize!==t.size&&this.recalculateAverage.newItems.push({$index:e.$index,size:t.size})),e.$index<this.minIndex&&(this.minIndex=e.$index),e.$index>this.maxIndex&&(this.maxIndex=e.$index),t},e.prototype.getItemSize=function(e){var t=this.get(e);return t?t.size:0},e.prototype.get=function(e){return this.items.get(e)},Object.defineProperty(e.prototype,"size",{get:function(){return this.items.size},enumerable:!1,configurable:!0}),e.prototype.removeItems=function(e,t){var i=new Map,n=1/0,r=-1/0;this.items.forEach((function(o){if(!e.some((function(e){return e===o.$index}))){var s=t?e.reduce((function(e,t){return e-(o.$index>t?1:0)}),0):e.reduce((function(e,t){return e+(o.$index<t?1:0)}),0);o.changeIndex(o.$index+s),i.set(o.$index,o),n=o.$index<n?o.$index:n,r=o.$index>r?o.$index:r}})),this.items=i,this.minIndex=n,this.maxIndex=r},e.prototype.insertItems=function(e,t,i){var n=this,r=new Map;this.items.forEach((function(o){var s=o.$index;s<e?(i||o.changeIndex(s-t),r.set(o.$index,o)):(i&&o.changeIndex(s+t),r.set(o.$index,o)),o.$index<n.minIndex&&(n.minIndex=o.$index),o.$index>n.maxIndex&&(n.maxIndex=o.$index)})),this.items=r},e}(),kt=function(){function e(e,t,i){this.logger=i,this.changeItems=t,this.bof=new a(!1),this.eof=new a(!1),this.cache=new It(e.itemSize,e.cacheData,i),this.startIndexUser=e.startIndex,this.minIndexUser=e.minIndex,this.maxIndexUser=e.maxIndex,this.reset()}return e.prototype.dispose=function(){this.bof.dispose(),this.eof.dispose()},e.prototype.reset=function(e,t){e&&this.items.forEach((function(e){return e.hide()})),this.pristine=!0,this.items=[],this.cache.reset(),this.absMinIndex=this.minIndexUser,this.absMaxIndex=this.maxIndexUser,this.setCurrentStartIndex(t),this.bof.set(!1),this.eof.set(!1),this.pristine=!1},e.prototype.setCurrentStartIndex=function(e){var t=this.minIndexUser,i=this.maxIndexUser,n=this.startIndexUser,r=Number(e);Number.isNaN(r)&&(this.logger.log((function(){return"fallback startIndex to settings.startIndex ("+n+")"})),r=n),r<t&&(this.logger.log((function(){return"setting startIndex to settings.minIndex ("+t+") because "+r+" < "+t})),r=t),r>i&&(this.logger.log((function(){return"setting startIndex to settings.maxIndex ("+i+") because "+r+" > "+i})),r=i),this.startIndex=r},Object.defineProperty(e.prototype,"items",{get:function(){return this._items},set:function(e){this._items=e,this.changeItems(e),this.pristine||(this.checkBOF(),this.checkEOF())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"absMinIndex",{get:function(){return this._absMinIndex},set:function(e){this._absMinIndex!==e&&(this._absMinIndex=e),this.pristine||this.checkBOF()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"absMaxIndex",{get:function(){return this._absMaxIndex},set:function(e){this._absMaxIndex!==e&&(this._absMaxIndex=e),this.pristine||this.checkEOF()},enumerable:!1,configurable:!0}),e.prototype.checkBOF=function(){var e=this.items.length?this.items[0].$index===this.absMinIndex:isFinite(this.absMinIndex);this.bof.set(e)},e.prototype.checkEOF=function(){var e=this.items.length?this.items[this.items.length-1].$index===this.absMaxIndex:isFinite(this.absMaxIndex);this.eof.set(e)},Object.defineProperty(e.prototype,"size",{get:function(){return this._items.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cacheSize",{get:function(){return this.cache.size},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"averageSize",{get:function(){return this.cache.averageSize},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasItemSize",{get:function(){return this.averageSize>0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"minIndex",{get:function(){return isFinite(this.cache.minIndex)?this.cache.minIndex:this.startIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxIndex",{get:function(){return isFinite(this.cache.maxIndex)?this.cache.maxIndex:this.startIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"firstIndex",{get:function(){return this.items.length?this.items[0].$index:NaN},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastIndex",{get:function(){return this.items.length?this.items[this.items.length-1].$index:NaN},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"finiteAbsMinIndex",{get:function(){return isFinite(this.absMinIndex)?this.absMinIndex:this.minIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"finiteAbsMaxIndex",{get:function(){return isFinite(this.absMaxIndex)?this.absMaxIndex:this.maxIndex},enumerable:!1,configurable:!0}),e.prototype.get=function(e){return this.items.find((function(t){return t.$index===e}))},e.prototype.setItems=function(e){if(this.items.length)if(this.items[0].$index>e[e.length-1].$index)this.items=(0,o.fl)(e,this.items);else{if(!(e[0].$index>this.items[this.items.length-1].$index))return!1;this.items=(0,o.fl)(this.items,e)}else this.items=(0,o.fl)(e);return!0},e.prototype.append=function(e){this.items=(0,o.fl)(this.items,e)},e.prototype.prepend=function(e){this.items=(0,o.fl)(e,this.items)},e.prototype.removeItems=function(e,t,i){void 0===i&&(i=!1);for(var n=[],r=i?e:[],o=this.items.length,s=function(o){var s=a.items[o];if(!i&&e.indexOf(s.$index)>=0)return r.push(s.$index),"continue";var l=r.reduce((function(e,i){return e+(t?s.$index>i?-1:0:s.$index<i?1:0)}),0);s.updateIndex(s.$index+l),i||(t?n.push(s):n.unshift(s))},a=this,l=t?0:o-1;t?l<o:l>=0;t?l++:l--)s(l);t?this.absMaxIndex-=r.length:(this.absMinIndex+=r.length,this.startIndex+=r.length),i||(this.items=n),this.cache.removeItems(r,t)},e.prototype.insertItems=function(e,t,i,n){var r=e.length,s=this.items.indexOf(t)+i,a=this.items.slice(0,s),l=this.items.slice(s);n?l.forEach((function(e){return e.updateIndex(e.$index+r)})):a.forEach((function(e){return e.updateIndex(e.$index-r)}));var c=(0,o.fl)(a,e,l);n?this.absMaxIndex+=r:(this.absMinIndex-=r,this.startIndex-=r),this.items=c,this.cache.insertItems(t.$index+i,r,n)},e.prototype.cacheItem=function(e){this.cache.add(e)},e.prototype.getFirstVisibleItemIndex=function(){for(var e=this.items.length,t=0;t<e;t++)if(!this.items[t].invisible)return t;return-1},e.prototype.getLastVisibleItemIndex=function(){for(var e=this.items.length-1;e>=0;e--)if(!this.items[e].invisible)return e;return-1},e.prototype.getFirstVisibleItem=function(){var e=this.getFirstVisibleItemIndex();if(e>=0)return this.items[e]},e.prototype.getLastVisibleItem=function(){var e=this.getLastVisibleItemIndex();if(e>=0)return this.items[e]},e.prototype.getEdgeVisibleItem=function(e,t){return e===(t?Le.backward:Le.forward)?this.getLastVisibleItem():this.getFirstVisibleItem()},e.prototype.getVisibleItemsCount=function(){return this.items.reduce((function(e,t){return e+(t.invisible?0:1)}),0)},e.prototype.getSizeByIndex=function(e){var t=this.cache.get(e);return t?t.size:this.averageSize},e.prototype.checkAverageSize=function(){return this.cache.recalculateAverageSize()},e.prototype.getIndexToAppend=function(e){return(e?this.absMaxIndex:this.size?this.items[this.size-1].$index:this.maxIndex)+(this.size?1:0)},e.prototype.getIndexToPrepend=function(e){return(e?this.absMinIndex:this.size?this.items[0].$index:this.minIndex)-(this.size?1:0)},e.prototype.getIndexToAdd=function(e,t){return t?this.getIndexToPrepend(e):this.getIndexToAppend(e)},e}(),St=function(){function e(e){this.total=e,this.isInitial=!1,this.busy=new a(!1)}return Object.defineProperty(e.prototype,"first",{get:function(){return 0===this.count},enumerable:!1,configurable:!0}),e.prototype.done=function(){this.count++,this.total++,this.busy.set(!1)},e.prototype.start=function(){this.busy.set(!0)},e.prototype.dispose=function(){this.busy.dispose()},e}(),zt=function(){function e(e,t){var i=t?t.count:1,n=t?t.innerLoop.count:0;this.instanceIndex=e,this.innerLoop=new St(n),this.interrupter=null,this.busy=new a(!1),this.done(i)}return Object.defineProperty(e.prototype,"loopId",{get:function(){return this.instanceIndex+"-"+this.count+"-"+this.innerLoop.total},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"loopIdNext",{get:function(){return this.instanceIndex+"-"+this.count+"-"+(this.innerLoop.total+1)},enumerable:!1,configurable:!0}),e.prototype.done=function(e){this.count=e,this.isInitial=!1,this.busy.set(!1)},e.prototype.start=function(e,t){this.isInitial=e,this.initiator=t,this.innerLoop.isInitial=e,this.innerLoop.count=0,this.interrupter=null,this.busy.set(!0)},e.prototype.dispose=function(e){e&&this.busy.dispose(),this.innerLoop.dispose()},e}(),Ot=function(){function e(){this.reset()}return e.prototype.reset=function(){this.startDelta=0,this.before=0},e}(),Et=function(){function e(){this.reset()}return e.prototype.reset=function(){this.index=NaN,this.indexBuffer=NaN,this.position=NaN},e}(),Pt=function(){function e(){this.reset()}return e.prototype.reset=function(){this.index=NaN,this.indexBuffer=NaN},e}(),Nt=function(){function e(){this.callCount=0,this.positions=new Ot,this.first=new Et,this.last=new Pt,this.reset()}return e.prototype.reset=function(){this._newItemsData=null,this.items=[],this.positions.reset(),this.first.reset(),this.last.reset(),this.hasAnotherPack=!1,this.firstVisibleIndex=NaN,this.firstVisibleItemDelta=NaN,this.negativeSize=0,this.direction=null,this.cancel=null,this.simulate=!1,this.isPrepend=!1,this.isReplace=!1},Object.defineProperty(e.prototype,"newItemsData",{get:function(){return this._newItemsData},set:function(e){this._newItemsData=e,e&&e.length&&this.callCount++},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"shouldFetch",{get:function(){return!!this.count},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasNewItems",{get:function(){return!(!this._newItemsData||!this._newItemsData.length)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"index",{get:function(){return this.first.index},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"count",{get:function(){return isNaN(this.first.index)||isNaN(this.last.index)?0:this.last.index-this.first.index+1},enumerable:!1,configurable:!0}),e.prototype.startSimulate=function(e){this.simulate=!0,this._newItemsData=e.map((function(e){return e.data})),this.items=e,this.hasAnotherPack=!1,this.negativeSize=0},e.prototype.stopSimulate=function(){this.simulate=!1,this.isPrepend=!1,this.isReplace=!1},e.prototype.append=function(e){this.startSimulate(e),this.last.index=e[e.length-1].$index,this.first.index=e[0].$index,this.direction=Le.forward},e.prototype.prepend=function(e){this.startSimulate(e),this.last.index=e[0].$index,this.first.index=e[e.length-1].$index,this.direction=Le.backward,this.isPrepend=!0},e.prototype.replace=function(e){this.startSimulate(e),this.last.index=e[0].$index,this.first.index=e[e.length-1].$index,this.isReplace=!0},e.prototype.insert=function(e){this.startSimulate(e),this.last.index=e[0].$index,this.first.index=e[e.length-1].$index},e}(),Tt=function(){function e(){this.reset()}return Object.defineProperty(e.prototype,"all",{get:function(){return(0,o.fl)(this[Le.backward],this[Le.forward])},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"has",{get:function(){return!!this[Le.backward].length||!!this[Le.forward].length},enumerable:!1,configurable:!0}),e.prototype.reset=function(){this[Le.backward]=[],this[Le.forward]=[],this.only=!1},e}();Le.backward,Le.forward;var Mt=function(){function e(){this.infinite=!1,this.noClip=this.infinite,this.callCount=0,this.virtual=new Tt,this.reset()}return Object.defineProperty(e.prototype,"force",{get:function(){return this.forceForward||this.forceBackward},enumerable:!1,configurable:!0}),e.prototype.reset=function(e){this.doClip=!1,e?this.simulate=!1:this.forceReset(),this.increase=!1,this.virtual.reset()},e.prototype.forceReset=function(){this.simulate=!1,this.forceForward=!1,this.forceBackward=!1},e}(),Vt=function(){function e(){this.reset()}return Object.defineProperty(e.prototype,"noSize",{get:function(){return this.sizeBefore===this.sizeAfter},enumerable:!1,configurable:!0}),e.prototype.reset=function(){this.sizeBefore=0,this.sizeAfter=0,this.positionBefore=0,this.renderTimer=null},e}(),$t=function(){function e(){this.reset()}return e.prototype.reset=function(){this.previous=null,this.current=null,this.syntheticPosition=null,this.syntheticFulfill=!1,this.positionBeforeAsync=null,this.positionBeforeAdjust=null,this.positionAfterAdjust=null,this.cleanupTimers()},e.prototype.cleanupTimers=function(){this.scrollTimer&&(clearTimeout(this.scrollTimer),this.scrollTimer=null),this.animationFrameId&&(cancelAnimationFrame(this.animationFrameId),this.animationFrameId=0)},e.prototype.hasPositionChanged=function(e){var t=this.positionBeforeAdjust,i=this.positionAfterAdjust;return null===t||t!==e||null===i||i!==e},e}(),At=function(){function e(e,t,i){this.packageInfo=e,this.settings=t,this.initTime=Number(new Date),this.cycle=new zt(this.settings.instanceIndex,i?i.cycle:void 0),this.fetch=new Nt,this.clip=new Mt,this.render=new Vt,this.scrollState=new $t}return Object.defineProperty(e.prototype,"time",{get:function(){return Number(new Date)-this.initTime},enumerable:!1,configurable:!0}),e.prototype.endInnerLoop=function(){var e=this,t=e.fetch,i=e.render,n=e.cycle;t.cancel&&(t.cancel(),t.cancel=null),i.renderTimer&&(clearTimeout(i.renderTimer),i.renderTimer=null),n.innerLoop.done()},e.prototype.startInnerLoop=function(){var e=this,t=e.cycle,i=e.scrollState,n=e.fetch,r=e.render,o=e.clip;t.innerLoop.start(),i.positionBeforeAsync=null,n.simulate||n.reset(),o.simulate||o.reset(o.force),r.reset()},e.prototype.dispose=function(){this.cycle.dispose(),this.endInnerLoop(),this.scrollState.cleanupTimers()},e}(),jt=g(),Ct=function(e,t){return"object"==typeof e&&null!==e&&Object.prototype.hasOwnProperty.call(e,t)},Rt=function(e,t,i){var n=t;if(!Ct(t,"items")){var r=Array.isArray(t)?t:[t];n=e?{items:r,bof:i}:{items:r,eof:i}}return n},Lt={success:!1,immediate:!0,details:"Adapter is not initialized"},Ft=function(){function e(e,t,i){var n=this;this.source={},this.box={},this.demand={},this.wanted={},this.getWorkflow=t,this.logger=i,this.relax$=null,this.relaxRun=null,this.reloadCounter=0;var s=e||null,a=s&&s.reactiveConfiguredProps||{},l=s?jt.map((function(e){return(0,o.pi)((0,o.pi)({},e),{value:s[e.name]})})):g();Object.entries(a).forEach((function(e){var t=(0,o.CR)(e,2),i=t[0],n=t[1],r=l.find((function(e){return e.name===i}));r&&n&&(r.value=n.default)})),l.filter((function(e){var t=e.type,i=e.permanent;return t===r.Scalar&&i})).forEach((function(e){var t=e.name,i=e.value;return Object.defineProperty(n,t,{get:function(){return i}})})),l.filter((function(e){return e.type===r.Reactive})).forEach((function(e){var t=e.name,i=e.value;n.source[t]=i,Object.defineProperty(n,t,{get:function(){var e=jt.find((function(e){var i=e.wanted,n=e.reactive;return i&&n===t}));return e&&(n.wanted[e.name]=!0),n.source[t]}})})),l.filter((function(e){return e.type===r.Scalar&&!!e.reactive})).forEach((function(e){var t=e.name,i=e.value,r=e.reactive,o=e.wanted;o&&(n.wanted[t]=!1),n.box[t]=i,Object.defineProperty(n,t,{set:function(e){if(e!==n.box[t]){n.box[t]=e,n.source[r].set(e);var i=a[r];i&&i.emit(i.source,e)}},get:function(){return o&&(n.wanted[t]=!0),n.box[t]}})})),l.filter((function(e){return e.type===r.Scalar&&e.onDemand})).forEach((function(e){var t=e.name,i=e.value;n.demand[t]=i,Object.defineProperty(n,t,{get:function(){return n.demand[t]}})})),s&&(l.forEach((function(e){var t=e.name,i=e.type,o=n[t];i===r.Function?o=o.bind(n):i===r.WorkflowRunner?o=n.getPromisifiedMethod(o):i===r.Reactive&&a[t]&&(o=s[t]),Object.defineProperty(s,t,{configurable:!1,get:function(){return i===r.Scalar?n[t]:o}})})),delete s.reactiveConfiguredProps)}return Object.defineProperty(e.prototype,"workflow",{get:function(){return this.getWorkflow()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"reloadCount",{get:function(){return this.reloadCounter},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"reloadId",{get:function(){return this.id+"."+this.reloadCounter},enumerable:!1,configurable:!0}),e.prototype.getPromisifiedMethod=function(e){var t=this;return function(){for(var i=[],n=0;n<arguments.length;n++)i[n]=arguments[n];return new Promise((function(n){t.relax$&&t.relax$.once((function(e){return n(e)})),e.apply(t,i),t.relax$||n(Lt)}))}},e.prototype.initialize=function(e,t,i,r){var o=this;if(Object.defineProperty(this.demand,n.itemsCount,{get:function(){return e.getVisibleItemsCount()}}),Object.defineProperty(this.demand,n.bufferInfo,{get:function(){return{firstIndex:e.firstIndex,lastIndex:e.lastIndex,minIndex:e.minIndex,maxIndex:e.maxIndex,absMinIndex:e.absMinIndex,absMaxIndex:e.absMaxIndex}}}),this.bof=e.bof.get(),e.bof.on((function(e){return o.bof=e})),this.eof=e.eof.get(),e.eof.on((function(e){return o.eof=e})),Object.defineProperty(this.demand,n.packageInfo,{get:function(){return t.packageInfo}}),this.loopPending=t.cycle.innerLoop.busy.get(),t.cycle.innerLoop.busy.on((function(e){return o.loopPending=e})),this.isLoading=t.cycle.busy.get(),t.cycle.busy.on((function(e){return o.isLoading=e})),this.logger=i,r){this.relax$||(this.relax$=new a);var s=this.relax$;r.on((function(e){var t=e.status,i=e.payload,n=function(){};t===K.start&&(n=o.isLoading$.on((function(e){e||(n(),s.set({success:!0,immediate:!1,details:null}))}))),t!==K.done&&t!==K.error||(n(),s.set({success:t!==K.error,immediate:!0,details:t===K.error&&i?String(i.error):null}))}))}this.init=!0},e.prototype.dispose=function(){this.relax$&&this.relax$.dispose(),Object.values(this.source).forEach((function(e){return e.dispose()}))},e.prototype.reset=function(e){this.reloadCounter++,this.logger.logAdapterMethod("reset",e," of "+this.reloadId),this.workflow.call({process:Q.reset,status:K.start,payload:{options:e}})},e.prototype.reload=function(e){this.reloadCounter++,this.logger.logAdapterMethod("reload",e," of "+this.reloadId),this.workflow.call({process:Q.reload,status:K.start,payload:{options:e}})},e.prototype.append=function(e,t){var i=Rt(!1,e,t);this.logger.logAdapterMethod("append",[i.items,i.eof]),this.workflow.call({process:Q.append,status:K.start,payload:{options:i}})},e.prototype.prepend=function(e,t){var i=Rt(!0,e,t);this.logger.logAdapterMethod("prepend",[i.items,i.bof]),this.workflow.call({process:Q.prepend,status:K.start,payload:{options:i}})},e.prototype.check=function(){this.logger.logAdapterMethod("check"),this.workflow.call({process:Q.check,status:K.start})},e.prototype.remove=function(e){e=function(e){return Ct(e,"predicate")||Ct(e,"indexes")||(e={predicate:e}),e}(e),this.logger.logAdapterMethod("remove",e),this.workflow.call({process:Q.remove,status:K.start,payload:{options:e}})},e.prototype.clip=function(e){this.logger.logAdapterMethod("clip",e),this.workflow.call({process:Q.clip,status:K.start,payload:{options:e}})},e.prototype.insert=function(e){this.logger.logAdapterMethod("insert",e),this.workflow.call({process:Q.insert,status:K.start,payload:{options:e}})},e.prototype.replace=function(e){this.logger.logAdapterMethod("replace",e),this.workflow.call({process:Q.replace,status:K.start,payload:{options:e}})},e.prototype.fix=function(e){this.logger.logAdapterMethod("fix",e),this.workflow.call({process:Q.fix,status:K.start,payload:{options:e}})},e.prototype.relaxUnchained=function(e,t){var i=this,n=function(){return"function"==typeof e&&t===i.reloadId&&e()};return this.isLoading||n(),new Promise((function(e){i.isLoading?i.isLoading$.once((function(){n(),e(!1)})):e(!0)})).then((function(e){var n=t===i.reloadId;return i.logger.log((function(){return n?void 0:"relax promise cancelled due to "+t+" != "+i.reloadId})),{immediate:e,success:n,details:n?null:"Interrupted by reload or reset"}}))},e.prototype.relax=function(e){var t=this,i=this.reloadId;return this.logger.logAdapterMethod("relax",e," of "+i),this.init?this.relaxRun=this.relaxRun?this.relaxRun.then((function(){return t.relaxUnchained(e,i)})):this.relaxUnchained(e,i).then((function(e){return t.relaxRun=null,e})):Promise.resolve(Lt)},e.prototype.showLog=function(){this.logger.logAdapterMethod("showLog"),this.logger.logForce()},e}(),Bt=0,Dt=function(){function e(e){var t=e.datasource,i=e.consumer,n=e.element,r=e.workflow,o=e.scroller,a=A(t,_).params.get;if(!a.isValid)throw new Error("Invalid datasource: "+a.errors[0]);var l=o?o.state.packageInfo:{consumer:i,core:s};n=o?o.viewport.element:n,r=o?o.workflow:r,this.workflow=r,this.settings=new _e(t.settings,t.devSettings,++Bt),this.logger=new gt(this,l),this.routines=new mt(this.settings),this.state=new At(l,this.settings,o?o.state:void 0),this.buffer=new kt(this.settings,r.onDataChanged,this.logger),this.viewport=new xt(n,this.settings,this.routines,this.state,this.logger),this.logger.object("uiScroll settings object",this.settings,!0),this.initDatasource(t,o)}return e.prototype.initDatasource=function(e,t){var i=this;if(t)return this.datasource=e,void(this.adapter=t.adapter);var n=e instanceof b,r=!n&&!this.settings.adapter;if(n)this.datasource=e;else{var o=x((function(){return{mock:r}}));this.datasource=new o(e),this.settings.adapter&&(e.adapter=this.datasource.adapter)}var s=r?null:this.datasource.adapter;this.adapter=new Ft(s,(function(){return i.workflow}),this.logger)},e.prototype.init=function(e){this.viewport.reset(this.buffer.startIndex),this.logger.stat("initialization"),this.adapter.initialize(this.buffer,this.state,this.logger,e)},e.prototype.dispose=function(e){e&&this.adapter.dispose(),this.buffer.dispose(),this.state.dispose()},e.prototype.finalize=function(){},e}(),_t=function(){function e(e){var t=this,i=e.element,n=e.datasource,r=e.consumer,o=e.run;this.isInitialized=!1,this.initTimer=null,this.adapterRun$=new a,this.cyclesDone=0,this.interruptionCount=0,this.errors=[],this.disposeScrollEventHandler=function(){return null},this.propagateChanges=o,this.stateMachineMethods={run:this.runProcess(),interrupt:this.interrupt.bind(this),done:this.done.bind(this),onError:this.onError.bind(this)},this.scroller=new Dt({element:i,datasource:n,consumer:r,workflow:this.getUpdater()}),this.scroller.settings.initializeDelay?this.initTimer=setTimeout((function(){t.initTimer=null,t.init()}),this.scroller.settings.initializeDelay):this.init()}return e.prototype.init=function(){var e=this;this.scroller.init(this.adapterRun$),this.isInitialized=!0,this.callWorkflow({process:J.init,status:K.start});var t=this.scroller.viewport.scrollEventReceiver,i=function(t){return e.callWorkflow({process:J.scroll,status:K.start,payload:{event:t}})};t.addEventListener("scroll",i),this.disposeScrollEventHandler=function(){return t.removeEventListener("scroll",i)}},e.prototype.changeItems=function(e){this.propagateChanges(e)},e.prototype.callWorkflow=function(e){this.isInitialized&&(e.process&&e.process.startsWith("adapter")&&this.adapterRun$.set(e),this.process(e))},e.prototype.getUpdater=function(){return{call:this.callWorkflow.bind(this),onDataChanged:this.changeItems.bind(this)}},e.prototype.process=function(e){var t=e.status,i=e.process,n=e.payload;this.scroller.settings.logProcessRun&&this.scroller.logger.log((function(){return(0,o.fl)(["%cfire%c"],["color: #cc7777;","color: #000000;"],[i,'"'+t+'"'],void 0!==n?[n]:[])})),this.scroller.logger.logProcess(e),i===J.end&&this.scroller.finalize(),function(e){var t=e.input,i=t.process,n=t.status,r=t.payload,s=void 0===r?{}:r,a=e.methods,l=a.run,c=a.interrupt,u=a.done,f=a.onError;if(n===K.error)return f(i,s),void(i.startsWith("adapter")||l(ht)(s));var d=s.options;switch(i){case J.init:n===K.start&&l(Ge)(i),n===K.next&&l(ot)();break;case J.scroll:n===K.start&&l(He)(s),n===K.next&&l(Ge)(i);break;case Q.reset:case Q.reload:n===K.start&&(i===Q.reset?l(Xe)(d):l(qe)(d)),n===K.next&&(c((0,o.pi)({process:i},s)),s.finalize?l(ht)():l(Ge)(i));break;case Q.append:case Q.prepend:n===K.start&&l(Je)({process:i,options:d}),n===K.next&&l(Ge)(i);break;case Q.check:n===K.start&&l(Qe)(),n===K.next&&l(Ge)(i);break;case Q.remove:n===K.start&&l(Ke)(d),n===K.next&&l(Ge)(i);break;case Q.clip:n===K.start&&l(et)(d),n===K.next&&l(Ge)(i);break;case Q.insert:n===K.start&&l(tt)(d),n===K.next&&l(Ge)(i);break;case Q.replace:n===K.start&&l(it)(d),n===K.next&&l(Ge)(i);break;case Q.fix:n===K.start&&l(rt)(d),n===K.next&&l(Ge)(i);break;case J.start:switch(s.process){case Q.append:case Q.check:case Q.insert:case Q.replace:l(ct)();break;case Q.remove:l(dt)();break;default:l(st)()}break;case J.preFetch:if(n===K.next)switch(s.process){case Q.clip:l(ft)();break;default:l(at)()}n===K.done&&l(ht)();break;case J.fetch:l(lt)();break;case J.postFetch:n===K.next&&l(ct)(),n===K.done&&l(ht)();break;case J.render:if(n===K.next)switch(s.process){case Q.append:case Q.check:case Q.insert:case Q.remove:l(ut)();break;case Q.replace:l(dt)();break;default:l(ft)()}n===K.done&&l(ht)();break;case J.preClip:s.doClip?l(dt)():l(ut)();break;case J.clip:switch(s.process){case Q.remove:l(ht)();break;default:l(ut)()}break;case J.adjust:l(ht)();break;case J.end:if(n===K.next)switch(s.process){case Q.reset:case Q.reload:u(),l(Ge)(s.process);break;default:l(ot)()}n===K.done&&u()}}({input:e,methods:this.stateMachineMethods})},e.prototype.runProcess=function(){var e=this;return function(t){var i=t.run,n=t.process,r=t.name;return function(){for(var t=[],s=0;s<arguments.length;s++)t[s]=arguments[s];e.scroller.settings.logProcessRun&&e.scroller.logger.log((function(){return(0,o.fl)(["%crun%c"],["color: #333399;","color: #000000;"],[n||r],t)})),i.apply(void 0,(0,o.fl)([e.scroller],t))}}},e.prototype.onError=function(e,t){var i=t&&String(t.error)||"",n=this.scroller.state,r=n.time,o=n.cycle;this.errors.push({process:e,message:i,time:r,loop:o.loopIdNext}),this.scroller.logger.logError(i)},e.prototype.interrupt=function(e){var t=this,i=e.process,n=e.finalize,r=e.datasource;if(n){var o=this.scroller,s=o.workflow,a=o.logger;s.call=function(e){return a.log("[skip wf call]")},s.call.interrupted=!0,this.scroller.workflow=this.getUpdater(),this.interruptionCount++,a.log((function(){return"workflow had been interrupted by the "+i+" process ("+t.interruptionCount+")"}))}r&&this.scroller.adapter.relax((function(){t.scroller.logger.log("new Scroller instantiation");var e=new Dt({datasource:r,scroller:t.scroller});t.scroller.dispose(),t.scroller=e,t.scroller.init()}))},e.prototype.done=function(){var e=this.scroller,t=e.state,i=e.logger;this.cyclesDone++,i.logCycle(!1),t.cycle.done(this.cyclesDone+1),this.finalize()},e.prototype.dispose=function(){this.initTimer&&clearTimeout(this.initTimer),this.disposeScrollEventHandler(),this.adapterRun$.dispose(),this.scroller.dispose(!0),this.isInitialized=!1},e.prototype.finalize=function(){},e}()}}]);
//# sourceMappingURL=vendors.js.map